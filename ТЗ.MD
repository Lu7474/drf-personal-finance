# Техническое задание

## Backend API сервиса учёта личных финансов


## 1. Цель проекта

Разработать backend REST API для учёта личных финансов с поддержкой:

* пользователей
* счетов
* доходов и расходов
* категорий
* отчетов

Проект предназначен для:

* демонстрации backend-навыков
* практики архитектуры
* подготовки к техническим собеседованиям

Фронтенд отсутствует. Взаимодействие через HTTP API.


## 2. Технологический стек

Обязательный:

* Python 3.11+
* Django + Django REST Framework
* PostgreSQL
* Redis
* Docker, docker-compose
* Nginx
* pytest
* JWT (access + refresh)

Дополнительно:

* S3-совместимое хранилище
* CI/CD (GitHub Actions или аналог)


## 3. Общая архитектура

* REST API
* Stateless backend
* JWT-авторизация
* Отдельные слои:

  * API
  * бизнес-логика
  * доступ к данным
* Конфигурация через environment variables
* Контейнеризация через Docker


## 4. Сущности и модель данных

### 4.1 Пользователь (User)

* id
* email (уникальный)
* password_hash
* is_active
* role (user / admin)
* created_at

---

### 4.2 Счёт (Account)

* id
* user_id (FK)
* name
* balance
* currency
* created_at

---

### 4.3 Категория (Category)

* id
* user_id (FK)
* name
* type (income / expense)

---

### 4.4 Операция (Transaction)

* id
* user_id (FK)
* account_id (FK)
* category_id (FK)
* type (income / expense)
* amount
* description
* date
* created_at

Индексы:

* user_id
* date
* account_id

---

## 5. API. Авторизация

### 5.1 Регистрация

`POST /auth/register`

### 5.2 Логин

`POST /auth/login`

Возвращает:

* access token
* refresh token

### 5.3 Обновление токена

`POST /auth/refresh`

---

## 6. API. Основной функционал

### 6.1 Счета

* `GET /accounts`
* `POST /accounts`
* `GET /accounts/{id}`
* `PUT /accounts/{id}`
* `DELETE /accounts/{id}`

---

### 6.2 Категории

* `GET /categories`
* `POST /categories`
* `PUT /categories/{id}`
* `DELETE /categories/{id}`

---

### 6.3 Операции

* `GET /transactions`

  * фильтрация по дате
  * фильтрация по счету
  * пагинация
* `POST /transactions`
* `GET /transactions/{id}`
* `DELETE /transactions/{id}`

---

## 7. Отчеты

### 7.1 Отчет по периоду

`GET /reports/summary?from=&to=`

Ответ:

* общий доход
* общий расход
* баланс

### 7.2 Отчет по категориям

`GET /reports/by-category?from=&to=`

---

## 8. Redis (кэширование)

Использовать Redis для:

* кэширования отчетов
* TTL 5–15 минут
* инвалидация при создании новой операции

---

## 9. Асинхронные задачи (опционально)

* Генерация отчетов
* Отправка email

Через брокер сообщений.

---

## 10. S3-хранилище

* Экспорт отчетов в CSV
* Загрузка файлов в S3
* Получение presigned URL

---

## 11. Логирование

* logging
* уровни: INFO, WARNING, ERROR
* логирование:

  * запросов
  * ошибок
  * бизнес-событий

---

## 12. Тестирование

Покрыть тестами:

* регистрацию и логин
* CRUD счетов
* CRUD операций
* отчеты

Типы тестов:

* unit
* integration

---

## 13. Docker

* Dockerfile для backend
* docker-compose:

  * backend
  * postgres
  * redis

---

## 14. Nginx

* reverse proxy
* проксирование запросов к backend
* настройка headers

---

## 15. CI/CD

Pipeline:

* запуск тестов
* линтер
* билд Docker образа

---

## 16. Нефункциональные требования

* код по PEP8
* читаемая структура проекта
* README с описанием запуска
* миграции БД
* защита эндпоинтов авторизацией

---

## 17. Критерии готовности

Проект считается завершенным, если:

* все эндпоинты работают
* тесты проходят
* проект поднимается через docker-compose
* API задокументировано (Swagger/OpenAPI)

---
